# File: HVI Model/model/generate_vulnerability_score.py

import pandas as pd

# Load the temperature-enriched dataset
df = pd.read_csv("HVI Model/data/processed/features_with_temp_weighted.csv")

# Drop rows with missing values
df = df.dropna()

# Calculate vulnerability score (weighted sum; you can tweak weights)
df["vulnerability_score"] = (
    0.5 * df["building_density"] -
    0.3 * df["tree_density"] +
    0.2 * df["avg_temp"]
)

# Clip to [0, 1] range for consistency
df["vulnerability_score"] = df["vulnerability_score"].clip(0, 1)

# Save updated file
df.to_csv("HVI Model/data/processed/features_with_vulnerability.csv", index=False)
print("âœ… vulnerability_score added and file saved!")
